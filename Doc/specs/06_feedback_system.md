# 06_feedback_system.md

## 概要
AIの分析結果および親のアクションに基づき、子供へフィードバックを表示するロジックとUI仕様。
RPGの「リザルト画面」のようなワクワク感と、「頑張ったことを認めてもらえる」嬉しさを演出する。

## フィードバック体験 (UX)

### 1. クエスト完了リザルト (Instant Feedback)
*   **演出**:
    *   解析完了後、ドラムロール演出 → スコア「ドン！」表示。
    *   スコアに応じて背景エフェクト変化（80点以上なら紙吹雪やファンファーレ）。
*   **AI Coach Comment**:
    *   キャラクター（相棒）が吹き出しで喋る。
    *   シナリオ通り、「具体的な行動」を褒める内容。
    *   例: 「すごい！30分でこれだけ進めたね！特に**問3の図を書いた跡**、しっかり考えてる証拠だよ！」
*   **Energy Gain**:
    *   獲得したエネルギーがゲージに溜まっていくアニメーション。
    *   `Base` + `Bonus` の内訳を表示（「丁寧ボーナス +15分！」）。

### 2. 親からの承認通知 (Parent Approval)
*   **タイミング**: 親がダッシュボードで承認/スタンプした時。
*   **UI**:
    *   ホーム画面あるいはポップアップで通知。
    *   「お母さんから**花丸スタンプ**が届きました！」
    *   「**Parent Boost** ゲット！ +10分」

## データ連携
*   `quest_results` ドキュメントの `aiComments` フィールドと `tags` フィールドをフロントエンドでパースして表示する。
*   タグ（`["解き直し", "図解あり"]`）は、リザルト画面でバッジとして目立つように表示する。

## 受け入れ条件 (Acceptance Criteria)
1.  AIのコメントが、単なる定型文ではなく、APIから返ってきた動的な内容を表示していること。
2.  獲得エネルギーの内訳（基本分＋ボーナス分）が子供に伝わるUIであること。
3.  親からのリアクションが、子供にとって「嬉しいイベント」として演出されていること。
