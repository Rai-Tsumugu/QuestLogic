# 02_camera_capture.md

## 概要
学習前（Before）と学習後（After）の画像を撮影し、学習中の集中状態を担保するフロー。

## UI/UX フロー詳細

### 1. Before撮影 (クエスト開始)
*   **ガイド**: 「机の上を片付けて、ノートを広げよう」
*   **撮影**:
    *   **Grid**: ノートの罫線と合わせるためのグリッド表示。
    *   **Leveler**: スマホが水平になったときのみシャッターボタンを有効化（真上からの撮影を強制）。
*   **Action**: 撮影完了と同時に「学習タイマー」スタート。

### 2. 学習中 (Concentration Mode)
シナリオにある「スマホは集中モードに入り」を実現する。
*   **画面**: シンプルなデジタル時計と、「集中！」の文字のみ。
*   **制限**:
    *   アプリをバックグラウンドに送る（他のアプリを開く）と、警告通知を出す。
    *   「他のアプリを開いている時間は、学習時間としてカウントしない」ロジックを実装。
    *   (OS仕様上可能な範囲で) 通知の抑制。

### 3. After撮影 (クエスト完了)
*   **Ghost Overlay (ゴースト表示)**:
    *   **目的**: Beforeと同じ位置・倍率で撮影させることで、AIの差分解析精度を最大化する。
    *   **UI**: カメラプレビューの上に、Before画像を透過率30-50%で重ねる。
    *   **Guide**: 「前の写真と重なるように撮ってね」
*   **アップロード**: 撮影後、ユーザーを待たせずにバックグラウンドでアップロード開始。「解析中...」のアニメーションへ遷移。

## データ要件
*   `startedAt`: Before撮影時刻
*   `finishedAt`: After撮影時刻
*   `backgroundTime`: アプリがバックグラウンドにいた累積時間 (サボり判定用)
*   `netDuration`: `(finishedAt - startedAt) - backgroundTime`

## 受け入れ条件 (Acceptance Criteria)
1.  **Ghost Overlay**: After撮影時にBefore画像が半透明で表示され、位置合わせが容易であること。
2.  **Concentration**: アプリを閉じていた時間が計測され、実学習時間から除外（または警告）されること。
3.  **Leveler**: 傾いた状態での撮影を防ぐ（あるいは警告を出す）こと。
